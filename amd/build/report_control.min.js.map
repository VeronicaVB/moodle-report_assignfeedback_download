{"version":3,"sources":["../src/report_control.js"],"names":["define","Controls","userids","self","prototype","main","initeventhablers","selectaction","t","document","getElementById","Array","from","rows","forEach","tr","checkbox","cells","firstChild","addEventListener","selectbyone","bind","selectall","checkedhandler","s","Y","log","checked","users","getAttribute","split","userid","length","includes","index","indexOf","splice","push","form","selectedusers","querySelector","value","e","target","id","init","control"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Defines the APIs used by log reports\n *\n * @package    report\n * @subpackage ibassessmentreport\n * @copyright  2021 Veronica Bermegui\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\"jquery\", \"core/ajax\", \"core/log\"], function ($, Ajax, Log) {\n  \"use strict\";\n\n  function init() {\n    Y.log(\"ibassessmentreport control...\");\n    let userids = [];\n    var control = new Controls(userids);\n    control.main();\n  }\n\n  function Controls(userids) {\n    let self = this;\n    self.userids = userids;\n  }\n\n  /**\n   * Run the controller.\n   *\n   */\n  Controls.prototype.main = function () {\n    let self = this;\n\n    self.initeventhablers();\n    //self.selectbyone();\n    self.selectaction();\n  };\n\n  Controls.prototype.initeventhablers = function () {\n    var self = this;\n    var t = document.getElementById(\"ibasesstableb\");\n    if (t) {\n      //  Collect all the users ids\n      Array.from(t.rows).forEach((tr) => {\n        const checkbox = tr.cells[0].firstChild;\n        checkbox.addEventListener(\"click\", self.selectbyone.bind(self, this));\n      });\n    }\n  };\n\n  Controls.prototype.selectaction = function () {\n    var self = this;\n    var selectall = document.getElementById(\"selectall\");\n    selectall.addEventListener(\"click\", self.checkedhandler.bind(self, this));\n  };\n\n  Controls.prototype.checkedhandler = function (s, e) {\n    var t = document.getElementById(\"ibasesstableb\");\n    Y.log(s.userids);\n    if (t) {\n      //  Collect all the users ids\n      Array.from(t.rows).forEach((tr) => {\n        const checkbox = tr.cells[0].firstChild;\n        checkbox.checked = !checkbox.checked;\n        const users = checkbox.getAttribute(\"id\").split(\"_\");\n        const userid = users[users.length - 1];\n\n        if (!checkbox.checked && s.userids.includes(userid)) {\n          const index = s.userids.indexOf(userid);\n          if (index > -1) {\n            s.userids.splice(index, 1);\n          }\n        } else {\n          s.userids.push(users[users.length - 1]);\n        }\n      });\n    }\n    var form = document.getElementById(\"ibassessmentform\");\n    var selectedusers = form.querySelector('input[name=\"selectedusers\"]');\n    selectedusers.value = s.userids;\n  };\n\n  Controls.prototype.selectbyone = function (s, e) {\n    Y.log(s);\n    Y.log(e);\n    let userid = e.target.id;\n    userid = userid.split(\"_\");\n    userid = userid[userid.length - 1];\n\n    if (!e.target.checked && s.userids.includes(userid)) {\n      const index = s.userids.indexOf(userid);\n      if (index > -1) {\n        s.userids.splice(index, 1);\n      }\n    } else {\n      s.userids.push(userid);\n    }\n\n    var form = document.getElementById(\"ibassessmentform\");\n    var selectedusers = form.querySelector('input[name=\"selectedusers\"]');\n    selectedusers.value = s.userids;\n  };\n\n  return { init: init };\n});\n"],"file":"report_control.min.js"}