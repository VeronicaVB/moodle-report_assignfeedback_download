{"version":3,"sources":["../src/report_control.js"],"names":["define","$","Ajax","Log","html2pdf","Controls","userids","useritemids","self","prototype","main","selectbyone","selectallaction","rubricaction","instanceids","document","querySelector","getAttribute","getElementById","value","t","Array","from","rows","forEach","tr","checkbox","cells","firstChild","addEventListener","selectbyonehandler","bind","selectall","selectallhandler","s","checked","users","split","userid","length","innertable","uitemids","pop","push","includes","index","indexOf","splice","aux","filter","el","form","selectedusers","JSON","stringify","disabled","e","target","id","usersummary","selectedall","Y","log","user","innertabletr","i","children","frcontainer","firstElementChild","downloadrubric","currentTarget","frubric","filename","parse","spl","total","replace","set","margin","pagebreak","mode","html2canvas","scrollX","scrollY","save","init","control"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Defines the APIs used by log reports\n *\n * @package    report\n * @subpackage ibassessmentreport\n * @copyright  2021 Veronica Bermegui\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\"jquery\", \"core/ajax\", \"core/log\", \"report_assignfeedback_download/html2pdf\"], function ($, Ajax, Log, html2pdf) {\n    \"use strict\";\n\n    function init() {\n        Y.log(\"assignfeedback_download control...\");\n\n        let userids = [];\n        let useritemids = [];\n        var control = new Controls(userids, useritemids);\n        control.main();\n    }\n\n    function Controls(userids, useritemids) {\n        let self = this;\n        self.userids = userids;\n        self.useritemids = useritemids;\n    }\n\n    /**\n     * Run the controller.\n     *\n     */\n    Controls.prototype.main = function () {\n        let self = this;\n\n        self.selectbyone();\n        self.selectallaction();\n        self.rubricaction();\n\n        const instanceids = document\n            .querySelector(\"table.assignfeedback_download\")\n            .getAttribute(\"data-selected-assign\");\n        document\n            .getElementById(\"downloadactionform\")\n            .querySelector('input[name=\"instanceids\"]').value = instanceids;\n\n        //  self.downloadrubric();\n\n        //  document.getElementById(\"rubrictestdownload\").addEventListener(\"click\", self.downloadrubric);\n\n    };\n\n    Controls.prototype.selectbyone = function () {\n        let self = this;\n        let t = document.getElementById(\"iassignfeedbacktb\");\n        if (t) {\n            //  Collect all the users ids\n            Array.from(t.rows).forEach((tr) => {\n                const checkbox = tr.cells[0].firstChild;\n                checkbox.addEventListener(\n                    \"click\",\n                    self.selectbyonehandler.bind(self, this)\n                );\n            });\n        }\n    };\n\n    Controls.prototype.selectallaction = function () {\n        let self = this;\n        let selectall = document.getElementById(\"selectall\");\n        selectall.addEventListener(\"click\", self.selectallhandler.bind(self, this));\n    };\n\n    Controls.prototype.selectallhandler = function (s, e) {\n        let t = document.getElementById(\"iassignfeedbacktb\");\n        if (t) {\n            Array.from(t.rows).forEach((tr) => {\n                const checkbox = tr.cells[0].firstChild;\n                checkbox.checked = !checkbox.checked;\n                const users = checkbox.getAttribute(\"id\").split(\"_\");\n                const userid = users[users.length - 1];\n                const innertable = document.getElementById(`innertable_${userid}`);\n                const uitemids = innertable\n                    .getAttribute(\"data-user-grade-id\")\n                    .split(\",\");\n                uitemids.pop(); // Remove the last empty item.\n                const usersummary = {\n                    userid: userid,\n                    uitemids: uitemids\n                };\n                s.useritemids.push(usersummary);\n                if (!checkbox.checked && s.userids.includes(userid)) {\n                    const index = s.userids.indexOf(userid);\n                    if (index > -1) {\n                        s.userids.splice(index, 1);\n\n                        const aux = s.useritemids;\n                        s.useritemids = aux.filter(function (el) {\n                            if (el.userid != userid) {\n                                return el;\n                            }\n                        }, userid);\n                    }\n                } else {\n                    s.userids.push(users[users.length - 1]);\n                }\n            });\n        }\n\n        let form = document.getElementById(\"downloadactionform\");\n        let selectedusers = form.querySelector('input[name=\"selectedusers\"]');\n        let useritemids = form.querySelector('input[name=\"itemids\"]');\n        selectedusers.value = s.userids;\n        useritemids.value = JSON.stringify(s.useritemids);\n\n        // Enable the download select only if there are selected users.\n        if (selectedusers.value) {\n            document.getElementById(\"id_operation\").disabled = false;\n            document.getElementById(\"id_submit\").disabled = false;\n        } else {\n            document.getElementById(\"id_operation\").disabled = true;\n            document.getElementById(\"id_submit\").disabled = true;\n        }\n    };\n\n    Controls.prototype.selectbyonehandler = function (s, e) {\n        let userid = e.target.id;\n        userid = userid.split(\"_\");\n        userid = userid[userid.length - 1];\n        const innertable = document.getElementById(`innertable_${userid}`);\n        const uitemids = innertable.getAttribute(\"data-user-grade-id\").split(\",\");\n        uitemids.pop(); // Remove the last empty item.\n        const usersummary = {\n            userid: userid,\n            uitemids: uitemids\n        };\n        s.useritemids.push(usersummary);\n        const selectedall = document.getElementById(\"selectall\");\n\n        if (selectedall.checked) {\n            document.getElementById(\"selectall\").checked = false;\n        }\n\n        if (!e.target.checked && s.userids.includes(userid)) {\n            const index = s.userids.indexOf(userid);\n            if (index > -1) {\n                s.userids.splice(index, 1);\n                const aux = s.useritemids;\n                s.useritemids = aux.filter(function (el) {\n                    if (el.userid != userid) {\n                        return el;\n                    }\n                }, userid);\n            }\n        } else {\n            s.userids.push(userid);\n        }\n\n        let form = document.getElementById(\"downloadactionform\");\n        let selectedusers = form.querySelector('input[name=\"selectedusers\"]');\n        let useritemids = form.querySelector('input[name=\"itemids\"]');\n        selectedusers.value = s.userids;\n        useritemids.value = JSON.stringify(s.useritemids);\n\n        if (selectedusers.value) {\n            document.getElementById(\"id_operation\").disabled = false;\n            document.getElementById(\"id_submit\").disabled = false;\n        } else {\n            document.getElementById(\"id_operation\").disabled = true;\n            document.getElementById(\"id_submit\").disabled = true;\n        }\n    };\n\n    Controls.prototype.rubricaction = function () {\n        Y.log('rubricaction');\n        const self = this;\n        let t = document.getElementById(\"iassignfeedbacktb\");\n       \n        if (t) {\n\n            Array.from(t.rows).forEach((tr) => {\n                const checkbox = tr.cells[0].firstChild;\n                const user = checkbox.getAttribute(\"id\").split(\"_\");\n                const userid = user[user.length - 1];\n                const innertabletr = document.getElementById(`innertable_${userid}`).querySelector('tbody');\n                \n                for(let i = 0; i < innertabletr.rows.length; i++) {\n                    if (innertabletr.rows[i].cells[5].children.length > 0) { // It has  a rubric\n                        const frcontainer = innertabletr.rows[i].cells[5].firstElementChild;\n                        frcontainer.addEventListener('click', self.downloadrubric);\n\n                    }\n                }\n            }, self);\n        }\n    }\n    Controls.prototype.downloadrubric = function (e) {\n        Y.log(e.currentTarget);\n        let frubric = e.currentTarget.getAttribute('data-frubric-filling');\n        const filename = e.currentTarget.getAttribute('data-rubric-file-name');\n        if (frubric != '') {\n            frubric = JSON.parse(frubric);\n\n            // Format the end of the file, to display the grade as TOTAL: min/max\n            const spl = frubric.split('</div>');;\n            let total = spl[spl.length - 1];\n            const rept = \"<br> <strong>TOTAL: \" + total + \"</strong>\";\n            frubric = frubric.replace(total, rept);\n\n            let opt = {\n                margin: 1,\n                filename: filename,\n                pagebreak: {\n                    mode: 'legacy'\n                },\n                html2canvas: {\n                    scrollX: 0,\n                    scrollY: 0,\n                }\n\n            }\n\n            html2pdf().set(opt).from(frubric).save();\n        }\n\n    };\n\n    return {\n        init: init\n    };\n});"],"file":"report_control.min.js"}